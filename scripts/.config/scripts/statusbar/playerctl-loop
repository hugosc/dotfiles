#!/bin/sh

# Event-driven playerctl monitor using --follow flag
# Watches for metadata changes and signals dwmblocks to update

STATUSBAR="${STATUSBAR:-dwmblocks}"

# Use playerctl --follow to block and wait for metadata changes
# Then signal dwmblocks when they occur
playerctl metadata --follow --format '{{ artist }} - {{ title }}' 2>/dev/null | while read -r metadata; do
	pkill -RTMIN+11 "$STATUSBAR" 2>/dev/null
done

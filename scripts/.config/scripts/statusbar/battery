#!/usr/bin/env bash

# Battery status script for dwmblocks
BATTERY_PATH="/sys/class/power_supply/BAT0"

if [ ! -d "$BATTERY_PATH" ]; then
    echo "N/A"
    exit 0
fi

CAPACITY=$(cat "$BATTERY_PATH/capacity")
STATUS=$(cat "$BATTERY_PATH/status")

# Choose icon based on status and capacity
if [ "$STATUS" = "Charging" ]; then
    ICON="󰂄"
elif [ "$STATUS" = "Full" ]; then
    ICON="󰁹"
elif [ "$CAPACITY" -ge 80 ]; then
    ICON="󰂂"
elif [ "$CAPACITY" -ge 60 ]; then
    ICON="󰂁"
elif [ "$CAPACITY" -ge 40 ]; then
    ICON="󰂀"
elif [ "$CAPACITY" -ge 20 ]; then
    ICON="󰁻"
else
    ICON="󰂎"
fi

echo "$ICON $CAPACITY%"

# Click handler
case $BLOCK_BUTTON in
    3) notify-send "Battery" "Status: $STATUS\nCapacity: $CAPACITY%" ;;
esac

# Picom configuration for transparency management with DWM

# Backend - GLX is usually best for tiling WMs
backend = "glx";
glx-no-stencil = true;
glx-no-rebind-pixmap = true;
glx-swap-method = 3;  # More stable with tiling WMs
xrender-sync-fence = true;

# VSync - Crucial for eliminating tearing
vsync = true;
present-method = "glx";  # Uses GLX present extension for smooth frame delivery
# present-method = "drm";  # Alternative: DRM page flipping (if available)

# Frame pacing
# Enable this for smoother repaints
use-damage = true;
damage-radius = 1;

# Shadows
shadow = false;

# Fading
fading = false;

# Opacity
inactive-opacity = 1.0;
active-opacity = 1.0;
frame-opacity = 1.0;

# Window-specific opacity rules
# Transparency controlled via toggle-transparency script (xprop)
# No static rules - dynamic control only
opacity-rule = [];

# Blur
blur-background = true;
blur-method = "dual_kawase";  # Fast and effective
blur-strength = 2;  # Reduced from 3 for better performance

# Blur region rules (only blur specific areas)
# Exclude windows where we don't want blur
blur-background-exclude = [
  "class_g = 'dwm'",
  "class_g = 'dmenu'",
  "class_g = 'qutebrowser'",  # Exclude qutebrowser - we rely on transparency instead
  "class_g = 'kitty'",        # Exclude kitty for performance
  "class_g = 'st-256color'",  # Exclude st for performance
  "class_g = 'Alacritty'",    # Exclude alacritty if you use it
];

# Window-specific blur for qutebrowser tab bar
# We'll use opacity rules to make tabs transparent + picom blur creates the effect
blur-background-fixed = false;

# Other
mark-wmwin-focused = true;
use-ewmh-active-window = true;
detect-rounded-corners = true;
detect-client-opacity = true;

# DWM-specific optimizations
# These help with window creation and positioning
detect-transient = true;
detect-client-leader = true;
